#include "motor/trigonometric.h"
#include <math.h>

static const float32_t Table_sin[316] = {
    0,           //	0
    0.01,        //	0.01
    0.019999,    //	0.02
    0.029996,    //	0.03
    0.039989,    //	0.04
    0.049979,    //	0.05
    0.059964,    //	0.06
    0.069943,    //	0.07
    0.079915,    //	0.08
    0.089879,    //	0.09
    0.099833,    //	0.1
    0.109778,    //	0.11
    0.119712,    //	0.12
    0.129634,    //	0.13
    0.139543,    //	0.14
    0.149438,    //	0.15
    0.159318,    //	0.16
    0.169182,    //	0.17
    0.17903,     //	0.18
    0.188859,    //	0.19
    0.198669,    //	0.2
    0.20846,     //	0.21
    0.21823,     //	0.22
    0.227978,    //	0.23
    0.237703,    //	0.24
    0.247404,    //	0.25
    0.257081,    //	0.26
    0.266731,    //	0.27
    0.276356,    //	0.28
    0.285952,    //	0.29
    0.29552,     //	0.3
    0.305059,    //	0.31
    0.314567,    //	0.32
    0.324043,    //	0.33
    0.333487,    //	0.34
    0.342898,    //	0.35
    0.352274,    //	0.36
    0.361615,    //	0.37
    0.37092,     //	0.38
    0.380188,    //	0.39
    0.389418,    //	0.4
    0.398609,    //	0.41
    0.40776,     //	0.42
    0.416871,    //	0.43
    0.425939,    //	0.44
    0.434966,    //	0.45
    0.443948,    //	0.46
    0.452886,    //	0.47
    0.461779,    //	0.48
    0.470626,    //	0.49
    0.479426,    //	0.5
    0.488177,    //	0.51
    0.49688,     //	0.52
    0.505533,    //	0.53
    0.514136,    //	0.54
    0.522687,    //	0.55
    0.531186,    //	0.56
    0.539632,    //	0.57
    0.548024,    //	0.58
    0.556361,    //	0.59
    0.564642,    //	0.6
    0.572867,    //	0.61
    0.581035,    //	0.62
    0.589145,    //	0.63
    0.597195,    //	0.64
    0.605186,    //	0.65
    0.613117,    //	0.66
    0.620986,    //	0.67
    0.628793,    //	0.68
    0.636537,    //	0.69
    0.644218,    //	0.7
    0.651834,    //	0.71
    0.659385,    //	0.72
    0.66687,     //	0.73
    0.674288,    //	0.74
    0.681639,    //	0.75
    0.688921,    //	0.76
    0.696135,    //	0.77
    0.703279,    //	0.78
    0.710353,    //	0.79
    0.717356,    //	0.8
    0.724287,    //	0.81
    0.731146,    //	0.82
    0.737931,    //	0.83
    0.744643,    //	0.84
    0.75128 ,    //	0.85
    0.757843,    //	0.86
    0.764329,    //	0.87
    0.770739,    //	0.88
    0.777072,    //	0.89
    0.783327,    //	0.9
    0.789504,    //	0.91
    0.795602,    //	0.92
    0.80162,     //	0.93
    0.807558,    //	0.94
    0.813416,    //	0.95
    0.819192,    //	0.96
    0.824886,    //	0.97
    0.830497,    //	0.98
    0.836026,    //	0.99
    0.841471,    //	1
    0.846832,    //	1.01
    0.852108,    //	1.02
    0.857299,    //	1.03
    0.862404,    //	1.04
    0.867423,    //	1.05
    0.872355,    //	1.06
    0.877201,    //	1.07
    0.881958,    //	1.08
    0.886627,    //	1.09
    0.891207,    //	1.1
    0.895699,    //	1.11
    0.9001,      //	1.12
    0.904412,    //	1.13
    0.908633,    //	1.14
    0.912764,    //	1.15
    0.916803,    //	1.16
    0.920751,    //	1.17
    0.924606,    //	1.18
    0.928369,    //	1.19
    0.932039,    //	1.2
    0.935616,    //	1.21
    0.939099,    //	1.22
    0.942489,    //	1.23
    0.945784,    //	1.24
    0.948985,    //	1.25
    0.95209,     //	1.26
    0.955101,    //	1.27
    0.958016,    //	1.28
    0.960835,    //	1.29
    0.963558,    //	1.3
    0.966185,    //	1.31
    0.968715,    //	1.32
    0.971148,    //	1.33
    0.973485,    //	1.34
    0.975723,    //	1.35
    0.977865,    //	1.36
    0.979908,    //	1.37
    0.981854,    //	1.38
    0.983701,    //	1.39
    0.98545,     //	1.4
    0.9871,     //	1.41
    0.988652,    //	1.42
    0.990105,    //	1.43
    0.991458,    //	1.44
    0.992713,    //	1.45
    0.993868,    //	1.46
    0.994924,    //	1.47
    0.995881,    //	1.48
    0.996738,    //	1.49
    0.997495,    //	1.5
    0.998152,    //	1.51
    0.99871,     //	1.52
    0.999168,    //	1.53
    0.999526,    //	1.54
    0.999784,    //	1.55
    0.999942,    //	1.56
    1,           //	1.57
    0.999958,    //	1.58
    0.999816,    //	1.59
    0.999574,    //	1.6
    0.999232,    //	1.61
    0.99879,     //	1.62
    0.998248,    //	1.63
    0.997606,    //	1.64
    0.996865,    //	1.65
    0.996024,    //	1.66
    0.995083,    //	1.67
    0.994043,    //	1.68
    0.992904,    //	1.69
    0.991665,    //	1.7
    0.990327,    //	1.71
    0.98889,     //	1.72
    0.987354,    //	1.73
    0.985719,    //	1.74
    0.983986,    //	1.75
    0.982154,    //	1.76
    0.980224,    //	1.77
    0.978197,    //	1.78
    0.976071,    //	1.79
    0.973848,    //	1.8
    0.971527,    //	1.81
    0.969109,    //	1.82
    0.966594,    //	1.83
    0.963983,    //	1.84
    0.961275,    //	1.85
    0.958471,    //	1.86
    0.955572,    //	1.87
    0.952576,    //	1.88
    0.949486,    //	1.89
    0.9463,      //	1.9
    0.94302,     //	1.91
    0.939645,    //	1.92
    0.936177,    //	1.93
    0.932615,    //	1.94
    0.92896,     //	1.95
    0.925212,    //	1.96
    0.921371,    //	1.97
    0.917438,    //	1.98
    0.913413,    //	1.99
    0.909297,    //	2
    0.905091,    //	2.01
    0.900793,    //	2.02
    0.896406,    //	2.03
    0.891929,    //	2.04
    0.887362,    //	2.05
    0.882707,    //	2.06
    0.877964,    //	2.07
    0.873133,    //	2.08
    0.868215,    //	2.09
    0.863209,    //	2.1
    0.858118,    //	2.11
    0.85294,     //	2.12
    0.847678,    //	2.13
    0.84233,     //	2.14
    0.836899,    //	2.15
    0.831383,    //	2.16
    0.825785,    //	2.17
    0.820104,    //	2.18
    0.814341,    //	2.19
    0.808496,    //	2.2
    0.802571,    //	2.21
    0.796565,    //	2.22
    0.79048 ,    //	2.23
    0.784316,    //	2.24
    0.778073,    //	2.25
    0.771753,    //	2.26
    0.765355,    //	2.27
    0.758881,    //	2.28
    0.752331,    //	2.29
    0.745705,    //	2.3
    0.739005,    //	2.31
    0.732231,    //	2.32
    0.725384,    //	2.33
    0.718465,    //	2.34
    0.711473,    //	2.35
    0.704411,    //	2.36
    0.697278,    //	2.37
    0.690075,    //	2.38
    0.682803,    //	2.39
    0.675463,    //	2.4
    0.668056,    //	2.41
    0.660581,    //	2.42
    0.653041,    //	2.43
    0.645435,    //	2.44
    0.637765,    //	2.45
    0.630031,    //	2.46
    0.622234,    //	2.47
    0.614374,    //	2.48
    0.606454,    //	2.49
    0.598472,    //	2.5
    0.590431,    //	2.51
    0.582331,    //	2.52
    0.574172,    //	2.53
    0.565956,    //	2.54
    0.557684,    //	2.55
    0.549355,    //	2.56
    0.540972,    //	2.57
    0.532535,    //	2.58
    0.524044,    //	2.59
    0.515501,    //	2.6
    0.506907,    //	2.61
    0.498262,    //	2.62
    0.489567,    //	2.63
    0.480823,    //	2.64
    0.472031,    //	2.65
    0.463191,    //	2.66
    0.454306,    //	2.67
    0.445375,    //	2.68
    0.436399,    //	2.69
    0.42738,     //	2.7
    0.418318,    //	2.71
    0.409214,    //	2.72
    0.400069,    //	2.73
    0.390885,    //	2.74
    0.381661,    //	2.75
    0.372399,    //	2.76
    0.3631,      //	2.77
    0.353764,    //	2.78
    0.344393,    //	2.79
    0.334988,    //	2.8
    0.325549,    //	2.81
    0.316078,    //	2.82
    0.306575,    //	2.83
    0.297041,    //	2.84
    0.287478,    //	2.85
    0.277886,    //	2.86
    0.268266,    //	2.87
    0.258619,    //	2.88
    0.248947,    //	2.89
    0.239249,    //	2.9
    0.229528,    //	2.91
    0.219784,    //	2.92
    0.210017,    //	2.93
    0.20023 ,    //	2.94
    0.190423,    //	2.95
    0.180596,    //	2.96
    0.170752,    //	2.97
    0.16089,     //	2.98
    0.151013,    //	2.99
    0.14112 ,    //	3
    0.131213,    //	3.01
    0.121293,    //	3.02
    0.111361,    //	3.03
    0.101418,    //	3.04
    0.091465,    //	3.05
    0.081502,    //	3.06
    0.071532,    //	3.07
    0.061554,    //	3.08
    0.05157,     //	3.09
    0.041581,    //	3.1
    0.031587,    //	3.11
    0.021591,    //	3.12
    0.011592,    //	3.13
    0.001593,    //	3.14
    -0.008407	 //	3.15
};//Table_sin END

static const int16_t Table_atan[1501]={
    0,    //0.00
    100,    //0.01
    200,    //0.02
    300,    //0.03
    400,    //0.04
    500,    //0.05
    599,    //0.06
    699,    //0.07
    798,    //0.08
    898,    //0.09
    997,    //0.10
    1096,    //0.11
    1194,    //0.12
    1293,    //0.13
    1391,    //0.14
    1489,    //0.15
    1587,    //0.16
    1684,    //0.17
    1781,    //0.18
    1878,    //0.19
    1974,    //0.20
    2070,    //0.21
    2166,    //0.22
    2261,    //0.23
    2355,    //0.24
    2450,    //0.25
    2544,    //0.26
    2637,    //0.27
    2730,    //0.28
    2823,    //0.29
    2915,    //0.30
    3006,    //0.31
    3097,    //0.32
    3187,    //0.33
    3277,    //0.34
    3367,    //0.35
    3456,    //0.36
    3544,    //0.37
    3631,    //0.38
    3719,    //0.39
    3805,    //0.40
    3891,    //0.41
    3976,    //0.42
    4061,    //0.43
    4145,    //0.44
    4229,    //0.45
    4311,    //0.46
    4394,    //0.47
    4475,    //0.48
    4556,    //0.49
    4636,    //0.50
    4716,    //0.51
    4795,    //0.52
    4874,    //0.53
    4951,    //0.54
    5028,    //0.55
    5105,    //0.56
    5181,    //0.57
    5256,    //0.58
    5330,    //0.59
    5404,    //0.60
    5477,    //0.61
    5550,    //0.62
    5622,    //0.63
    5693,    //0.64
    5764,    //0.65
    5834,    //0.66
    5903,    //0.67
    5972,    //0.68
    6040,    //0.69
    6107,    //0.70
    6174,    //0.71
    6240,    //0.72
    6306,    //0.73
    6371,    //0.74
    6435,    //0.75
    6499,    //0.76
    6562,    //0.77
    6624,    //0.78
    6686,    //0.79
    6747,    //0.80
    6808,    //0.81
    6868,    //0.82
    6928,    //0.83
    6987,    //0.84
    7045,    //0.85
    7103,    //0.86
    7160,    //0.87
    7217,    //0.88
    7273,    //0.89
    7328,    //0.90
    7383,    //0.91
    7438,    //0.92
    7491,    //0.93
    7545,    //0.94
    7598,    //0.95
    7650,    //0.96
    7702,    //0.97
    7753,    //0.98
    7804,    //0.99
    7854,    //0.100
    7904,    //0.101
    7953,    //0.102
    8002,    //0.103
    8050,    //0.104
    8098,    //0.105
    8145,    //0.106
    8192,    //0.107
    8238,    //0.108
    8284,    //0.109
    8330,    //0.110
    8375,    //0.111
    8419,    //0.112
    8464,    //0.113
    8507,    //0.114
    8551,    //0.115
    8593,    //0.116
    8636,    //0.117
    8678,    //0.118
    8719,    //0.119
    8761,    //0.120
    8801,    //0.121
    8842,    //0.122
    8882,    //0.123
    8921,    //0.124
    8961,    //0.125
    8999,    //0.126
    9038,    //0.127
    9076,    //0.128
    9114,    //0.129
    9151,    //0.130
    9188,    //0.131
    9225,    //0.132
    9261,    //0.133
    9297,    //0.134
    9332,    //0.135
    9368,    //0.136
    9403,    //0.137
    9437,    //0.138
    9472,    //0.139
    9505,    //0.140
    9539,    //0.141
    9572,    //0.142
    9605,    //0.143
    9638,    //0.144
    9670,    //0.145
    9703,    //0.146
    9734,    //0.147
    9766,    //0.148
    9797,    //0.149
    9828,    //0.150
    9859,    //0.151
    9889,    //0.152
    9919,    //0.153
    9949,    //0.154
    9978,    //0.155
    10008,    //0.156
    10037,    //0.157
    10065,    //0.158
    10094,    //0.159
    10122,    //0.160
    10150,    //0.161
    10178,    //0.162
    10205,    //0.163
    10232,    //0.164
    10259,    //0.165
    10286,    //0.166
    10313,    //0.167
    10339,    //0.168
    10365,    //0.169
    10391,    //0.170
    10416,    //0.171
    10442,    //0.172
    10467,    //0.173
    10492,    //0.174
    10517,    //0.175
    10541,    //0.176
    10565,    //0.177
    10589,    //0.178
    10613,    //0.179
    10637,    //0.180
    10660,    //0.181
    10684,    //0.182
    10707,    //0.183
    10730,    //0.184
    10752,    //0.185
    10775,    //0.186
    10797,    //0.187
    10819,    //0.188
    10841,    //0.189
    10863,    //0.190
    10885,    //0.191
    10906,    //0.192
    10927,    //0.193
    10949,    //0.194
    10969,    //0.195
    10990,    //0.196
    11011,    //0.197
    11031,    //0.198
    11051,    //0.199
    11071,    //0.200
    11091,    //0.201
    11111,    //0.202
    11131,    //0.203
    11150,    //0.204
    11170,    //0.205
    11189,    //0.206
    11208,    //0.207
    11227,    //0.208
    11245,    //0.209
    11264,    //0.210
    11282,    //0.211
    11300,    //0.212
    11319,    //0.213
    11337,    //0.214
    11354,    //0.215
    11372,    //0.216
    11390,    //0.217
    11407,    //0.218
    11425,    //0.219
    11442,    //0.220
    11459,    //0.221
    11476,    //0.222
    11492,    //0.223
    11509,    //0.224
    11526,    //0.225
    11542,    //0.226
    11558,    //0.227
    11575,    //0.228
    11591,    //0.229
    11607,    //0.230
    11623,    //0.231
    11638,    //0.232
    11654,    //0.233
    11669,    //0.234
    11685,    //0.235
    11700,    //0.236
    11715,    //0.237
    11730,    //0.238
    11745,    //0.239
    11760,    //0.240
    11775,    //0.241
    11789,    //0.242
    11804,    //0.243
    11818,    //0.244
    11833,    //0.245
    11847,    //0.246
    11861,    //0.247
    11875,    //0.248
    11889,    //0.249
    11903,    //0.250
    11917,    //0.251
    11930,    //0.252
    11944,    //0.253
    11957,    //0.254
    11971,    //0.255
    11984,    //0.256
    11997,    //0.257
    12010,    //0.258
    12023,    //0.259
    12036,    //0.260
    12049,    //0.261
    12062,    //0.262
    12074,    //0.263
    12087,    //0.264
    12100,    //0.265
    12112,    //0.266
    12124,    //0.267
    12137,    //0.268
    12149,    //0.269
    12161,    //0.270
    12173,    //0.271
    12185,    //0.272
    12197,    //0.273
    12209,    //0.274
    12220,    //0.275
    12232,    //0.276
    12243,    //0.277
    12255,    //0.278
    12266,    //0.279
    12278,    //0.280
    12289,    //0.281
    12300,    //0.282
    12311,    //0.283
    12322,    //0.284
    12333,    //0.285
    12344,    //0.286
    12355,    //0.287
    12366,    //0.288
    12377,    //0.289
    12387,    //0.290
    12398,    //0.291
    12408,    //0.292
    12419,    //0.293
    12429,    //0.294
    12440,    //0.295
    12450,    //0.296
    12460,    //0.297
    12470,    //0.298
    12480,    //0.299
    12490,    //0.300
    12500,    //0.301
    12510,    //0.302
    12520,    //0.303
    12530,    //0.304
    12540,    //0.305
    12549,    //0.306
    12559,    //0.307
    12569,    //0.308
    12578,    //0.309
    12588,    //0.310
    12597,    //0.311
    12606,    //0.312
    12616,    //0.313
    12625,    //0.314
    12634,    //0.315
    12643,    //0.316
    12652,    //0.317
    12661,    //0.318
    12670,    //0.319
    12679,    //0.320
    12688,    //0.321
    12697,    //0.322
    12706,    //0.323
    12714,    //0.324
    12723,    //0.325
    12732,    //0.326
    12740,    //0.327
    12749,    //0.328
    12757,    //0.329
    12766,    //0.330
    12774,    //0.331
    12782,    //0.332
    12791,    //0.333
    12799,    //0.334
    12807,    //0.335
    12815,    //0.336
    12823,    //0.337
    12831,    //0.338
    12839,    //0.339
    12847,    //0.340
    12855,    //0.341
    12863,    //0.342
    12871,    //0.343
    12879,    //0.344
    12887,    //0.345
    12894,    //0.346
    12902,    //0.347
    12910,    //0.348
    12917,    //0.349
    12925,    //0.350
    12932,    //0.351
    12940,    //0.352
    12947,    //0.353
    12955,    //0.354
    12962,    //0.355
    12970,    //0.356
    12977,    //0.357
    12984,    //0.358
    12991,    //0.359
    12998,    //0.360
    13006,    //0.361
    13013,    //0.362
    13020,    //0.363
    13027,    //0.364
    13034,    //0.365
    13041,    //0.366
    13048,    //0.367
    13055,    //0.368
    13062,    //0.369
    13068,    //0.370
    13075,    //0.371
    13082,    //0.372
    13089,    //0.373
    13095,    //0.374
    13102,    //0.375
    13109,    //0.376
    13115,    //0.377
    13122,    //0.378
    13128,    //0.379
    13135,    //0.380
    13141,    //0.381
    13148,    //0.382
    13154,    //0.383
    13160,    //0.384
    13167,    //0.385
    13173,    //0.386
    13179,    //0.387
    13186,    //0.388
    13192,    //0.389
    13198,    //0.390
    13204,    //0.391
    13210,    //0.392
    13216,    //0.393
    13222,    //0.394
    13228,    //0.395
    13234,    //0.396
    13240,    //0.397
    13246,    //0.398
    13252,    //0.399
    13258,    //0.400
    13264,    //0.401
    13270,    //0.402
    13276,    //0.403
    13281,    //0.404
    13287,    //0.405
    13293,    //0.406
    13299,    //0.407
    13304,    //0.408
    13310,    //0.409
    13316,    //0.410
    13321,    //0.411
    13327,    //0.412
    13332,    //0.413
    13338,    //0.414
    13343,    //0.415
    13349,    //0.416
    13354,    //0.417
    13360,    //0.418
    13365,    //0.419
    13371,    //0.420
    13376,    //0.421
    13381,    //0.422
    13387,    //0.423
    13392,    //0.424
    13397,    //0.425
    13402,    //0.426
    13408,    //0.427
    13413,    //0.428
    13418,    //0.429
    13423,    //0.430
    13428,    //0.431
    13433,    //0.432
    13438,    //0.433
    13443,    //0.434
    13448,    //0.435
    13453,    //0.436
    13458,    //0.437
    13463,    //0.438
    13468,    //0.439
    13473,    //0.440
    13478,    //0.441
    13483,    //0.442
    13488,    //0.443
    13493,    //0.444
    13497,    //0.445
    13502,    //0.446
    13507,    //0.447
    13512,    //0.448
    13517,    //0.449
    13521,    //0.450
    13526,    //0.451
    13531,    //0.452
    13535,    //0.453
    13540,    //0.454
    13545,    //0.455
    13549,    //0.456
    13554,    //0.457
    13558,    //0.458
    13563,    //0.459
    13567,    //0.460
    13572,    //0.461
    13576,    //0.462
    13581,    //0.463
    13585,    //0.464
    13590,    //0.465
    13594,    //0.466
    13598,    //0.467
    13603,    //0.468
    13607,    //0.469
    13612,    //0.470
    13616,    //0.471
    13620,    //0.472
    13624,    //0.473
    13629,    //0.474
    13633,    //0.475
    13637,    //0.476
    13641,    //0.477
    13646,    //0.478
    13650,    //0.479
    13654,    //0.480
    13658,    //0.481
    13662,    //0.482
    13666,    //0.483
    13671,    //0.484
    13675,    //0.485
    13679,    //0.486
    13683,    //0.487
    13687,    //0.488
    13691,    //0.489
    13695,    //0.490
    13699,    //0.491
    13703,    //0.492
    13707,    //0.493
    13711,    //0.494
    13715,    //0.495
    13719,    //0.496
    13722,    //0.497
    13726,    //0.498
    13730,    //0.499
    13734,    //0.500
    13738,    //0.501
    13742,    //0.502
    13745,    //0.503
    13749,    //0.504
    13753,    //0.505
    13757,    //0.506
    13761,    //0.507
    13764,    //0.508
    13768,    //0.509
    13772,    //0.510
    13775,    //0.511
    13779,    //0.512
    13783,    //0.513
    13786,    //0.514
    13790,    //0.515
    13794,    //0.516
    13797,    //0.517
    13801,    //0.518
    13805,    //0.519
    13808,    //0.520
    13812,    //0.521
    13815,    //0.522
    13819,    //0.523
    13822,    //0.524
    13826,    //0.525
    13829,    //0.526
    13833,    //0.527
    13836,    //0.528
    13840,    //0.529
    13843,    //0.530
    13847,    //0.531
    13850,    //0.532
    13853,    //0.533
    13857,    //0.534
    13860,    //0.535
    13863,    //0.536
    13867,    //0.537
    13870,    //0.538
    13874,    //0.539
    13877,    //0.540
    13880,    //0.541
    13883,    //0.542
    13887,    //0.543
    13890,    //0.544
    13893,    //0.545
    13897,    //0.546
    13900,    //0.547
    13903,    //0.548
    13906,    //0.549
    13909,    //0.550
    13913,    //0.551
    13916,    //0.552
    13919,    //0.553
    13922,    //0.554
    13925,    //0.555
    13928,    //0.556
    13932,    //0.557
    13935,    //0.558
    13938,    //0.559
    13941,    //0.560
    13944,    //0.561
    13947,    //0.562
    13950,    //0.563
    13953,    //0.564
    13956,    //0.565
    13959,    //0.566
    13962,    //0.567
    13965,    //0.568
    13968,    //0.569
    13971,    //0.570
    13974,    //0.571
    13977,    //0.572
    13980,    //0.573
    13983,    //0.574
    13986,    //0.575
    13989,    //0.576
    13992,    //0.577
    13995,    //0.578
    13998,    //0.579
    14001,    //0.580
    14003,    //0.581
    14006,    //0.582
    14009,    //0.583
    14012,    //0.584
    14015,    //0.585
    14018,    //0.586
    14021,    //0.587
    14023,    //0.588
    14026,    //0.589
    14029,    //0.590
    14032,    //0.591
    14035,    //0.592
    14037,    //0.593
    14040,    //0.594
    14043,    //0.595
    14046,    //0.596
    14048,    //0.597
    14051,    //0.598
    14054,    //0.599
    14056,    //0.600
    14059,    //0.601
    14062,    //0.602
    14065,    //0.603
    14067,    //0.604
    14070,    //0.605
    14073,    //0.606
    14075,    //0.607
    14078,    //0.608
    14080,    //0.609
    14083,    //0.610
    14086,    //0.611
    14088,    //0.612
    14091,    //0.613
    14093,    //0.614
    14096,    //0.615
    14099,    //0.616
    14101,    //0.617
    14104,    //0.618
    14106,    //0.619
    14109,    //0.620
    14111,    //0.621
    14114,    //0.622
    14116,    //0.623
    14119,    //0.624
    14121,    //0.625
    14124,    //0.626
    14126,    //0.627
    14129,    //0.628
    14131,    //0.629
    14134,    //0.630
    14136,    //0.631
    14139,    //0.632
    14141,    //0.633
    14144,    //0.634
    14146,    //0.635
    14148,    //0.636
    14151,    //0.637
    14153,    //0.638
    14156,    //0.639
    14158,    //0.640
    14160,    //0.641
    14163,    //0.642
    14165,    //0.643
    14167,    //0.644
    14170,    //0.645
    14172,    //0.646
    14175,    //0.647
    14177,    //0.648
    14179,    //0.649
    14181,    //0.650
    14184,    //0.651
    14186,    //0.652
    14188,    //0.653
    14191,    //0.654
    14193,    //0.655
    14195,    //0.656
    14197,    //0.657
    14200,    //0.658
    14202,    //0.659
    14204,    //0.660
    14206,    //0.661
    14209,    //0.662
    14211,    //0.663
    14213,    //0.664
    14215,    //0.665
    14218,    //0.666
    14220,    //0.667
    14222,    //0.668
    14224,    //0.669
    14226,    //0.670
    14229,    //0.671
    14231,    //0.672
    14233,    //0.673
    14235,    //0.674
    14237,    //0.675
    14239,    //0.676
    14241,    //0.677
    14244,    //0.678
    14246,    //0.679
    14248,    //0.680
    14250,    //0.681
    14252,    //0.682
    14254,    //0.683
    14256,    //0.684
    14258,    //0.685
    14260,    //0.686
    14263,    //0.687
    14265,    //0.688
    14267,    //0.689
    14269,    //0.690
    14271,    //0.691
    14273,    //0.692
    14275,    //0.693
    14277,    //0.694
    14279,    //0.695
    14281,    //0.696
    14283,    //0.697
    14285,    //0.698
    14287,    //0.699
    14289,    //0.700
    14291,    //0.701
    14293,    //0.702
    14295,    //0.703
    14297,    //0.704
    14299,    //0.705
    14301,    //0.706
    14303,    //0.707
    14305,    //0.708
    14307,    //0.709
    14309,    //0.710
    14311,    //0.711
    14313,    //0.712
    14315,    //0.713
    14316,    //0.714
    14318,    //0.715
    14320,    //0.716
    14322,    //0.717
    14324,    //0.718
    14326,    //0.719
    14328,    //0.720
    14330,    //0.721
    14332,    //0.722
    14334,    //0.723
    14335,    //0.724
    14337,    //0.725
    14339,    //0.726
    14341,    //0.727
    14343,    //0.728
    14345,    //0.729
    14347,    //0.730
    14348,    //0.731
    14350,    //0.732
    14352,    //0.733
    14354,    //0.734
    14356,    //0.735
    14358,    //0.736
    14359,    //0.737
    14361,    //0.738
    14363,    //0.739
    14365,    //0.740
    14367,    //0.741
    14368,    //0.742
    14370,    //0.743
    14372,    //0.744
    14374,    //0.745
    14375,    //0.746
    14377,    //0.747
    14379,    //0.748
    14381,    //0.749
    14382,    //0.750
    14384,    //0.751
    14386,    //0.752
    14388,    //0.753
    14389,    //0.754
    14391,    //0.755
    14393,    //0.756
    14395,    //0.757
    14396,    //0.758
    14398,    //0.759
    14400,    //0.760
    14401,    //0.761
    14403,    //0.762
    14405,    //0.763
    14406,    //0.764
    14408,    //0.765
    14410,    //0.766
    14411,    //0.767
    14413,    //0.768
    14415,    //0.769
    14416,    //0.770
    14418,    //0.771
    14420,    //0.772
    14421,    //0.773
    14423,    //0.774
    14425,    //0.775
    14426,    //0.776
    14428,    //0.777
    14430,    //0.778
    14431,    //0.779
    14433,    //0.780
    14434,    //0.781
    14436,    //0.782
    14438,    //0.783
    14439,    //0.784
    14441,    //0.785
    14442,    //0.786
    14444,    //0.787
    14446,    //0.788
    14447,    //0.789
    14449,    //0.790
    14450,    //0.791
    14452,    //0.792
    14454,    //0.793
    14455,    //0.794
    14457,    //0.795
    14458,    //0.796
    14460,    //0.797
    14461,    //0.798
    14463,    //0.799
    14464,    //0.800
    14466,    //0.801
    14467,    //0.802
    14469,    //0.803
    14471,    //0.804
    14472,    //0.805
    14474,    //0.806
    14475,    //0.807
    14477,    //0.808
    14478,    //0.809
    14480,    //0.810
    14481,    //0.811
    14483,    //0.812
    14484,    //0.813
    14486,    //0.814
    14487,    //0.815
    14489,    //0.816
    14490,    //0.817
    14492,    //0.818
    14493,    //0.819
    14494,    //0.820
    14496,    //0.821
    14497,    //0.822
    14499,    //0.823
    14500,    //0.824
    14502,    //0.825
    14503,    //0.826
    14505,    //0.827
    14506,    //0.828
    14507,    //0.829
    14509,    //0.830
    14510,    //0.831
    14512,    //0.832
    14513,    //0.833
    14515,    //0.834
    14516,    //0.835
    14517,    //0.836
    14519,    //0.837
    14520,    //0.838
    14522,    //0.839
    14523,    //0.840
    14524,    //0.841
    14526,    //0.842
    14527,    //0.843
    14529,    //0.844
    14530,    //0.845
    14531,    //0.846
    14533,    //0.847
    14534,    //0.848
    14536,    //0.849
    14537,    //0.850
    14538,    //0.851
    14540,    //0.852
    14541,    //0.853
    14542,    //0.854
    14544,    //0.855
    14545,    //0.856
    14546,    //0.857
    14548,    //0.858
    14549,    //0.859
    14550,    //0.860
    14552,    //0.861
    14553,    //0.862
    14554,    //0.863
    14556,    //0.864
    14557,    //0.865
    14558,    //0.866
    14560,    //0.867
    14561,    //0.868
    14562,    //0.869
    14564,    //0.870
    14565,    //0.871
    14566,    //0.872
    14567,    //0.873
    14569,    //0.874
    14570,    //0.875
    14571,    //0.876
    14573,    //0.877
    14574,    //0.878
    14575,    //0.879
    14576,    //0.880
    14578,    //0.881
    14579,    //0.882
    14580,    //0.883
    14582,    //0.884
    14583,    //0.885
    14584,    //0.886
    14585,    //0.887
    14587,    //0.888
    14588,    //0.889
    14589,    //0.890
    14590,    //0.891
    14592,    //0.892
    14593,    //0.893
    14594,    //0.894
    14595,    //0.895
    14596,    //0.896
    14598,    //0.897
    14599,    //0.898
    14600,    //0.899
    14601,    //0.900
    14603,    //0.901
    14604,    //0.902
    14605,    //0.903
    14606,    //0.904
    14607,    //0.905
    14609,    //0.906
    14610,    //0.907
    14611,    //0.908
    14612,    //0.909
    14613,    //0.910
    14615,    //0.911
    14616,    //0.912
    14617,    //0.913
    14618,    //0.914
    14619,    //0.915
    14621,    //0.916
    14622,    //0.917
    14623,    //0.918
    14624,    //0.919
    14625,    //0.920
    14626,    //0.921
    14628,    //0.922
    14629,    //0.923
    14630,    //0.924
    14631,    //0.925
    14632,    //0.926
    14633,    //0.927
    14635,    //0.928
    14636,    //0.929
    14637,    //0.930
    14638,    //0.931
    14639,    //0.932
    14640,    //0.933
    14641,    //0.934
    14642,    //0.935
    14644,    //0.936
    14645,    //0.937
    14646,    //0.938
    14647,    //0.939
    14648,    //0.940
    14649,    //0.941
    14650,    //0.942
    14651,    //0.943
    14653,    //0.944
    14654,    //0.945
    14655,    //0.946
    14656,    //0.947
    14657,    //0.948
    14658,    //0.949
    14659,    //0.950
    14660,    //0.951
    14661,    //0.952
    14662,    //0.953
    14664,    //0.954
    14665,    //0.955
    14666,    //0.956
    14667,    //0.957
    14668,    //0.958
    14669,    //0.959
    14670,    //0.960
    14671,    //0.961
    14672,    //0.962
    14673,    //0.963
    14674,    //0.964
    14675,    //0.965
    14676,    //0.966
    14678,    //0.967
    14679,    //0.968
    14680,    //0.969
    14681,    //0.970
    14682,    //0.971
    14683,    //0.972
    14684,    //0.973
    14685,    //0.974
    14686,    //0.975
    14687,    //0.976
    14688,    //0.977
    14689,    //0.978
    14690,    //0.979
    14691,    //0.980
    14692,    //0.981
    14693,    //0.982
    14694,    //0.983
    14695,    //0.984
    14696,    //0.985
    14697,    //0.986
    14698,    //0.987
    14699,    //0.988
    14700,    //0.989
    14701,    //0.990
    14702,    //0.991
    14703,    //0.992
    14704,    //0.993
    14705,    //0.994
    14706,    //0.995
    14707,    //0.996
    14708,    //0.997
    14709,    //0.998
    14710,    //0.999
    14711,    //0.1000
    14712,    //0.1001
    14713,    //0.1002
    14714,    //0.1003
    14715,    //0.1004
    14716,    //0.1005
    14717,    //0.1006
    14718,    //0.1007
    14719,    //0.1008
    14720,    //0.1009
    14721,    //0.1010
    14722,    //0.1011
    14723,    //0.1012
    14724,    //0.1013
    14725,    //0.1014
    14726,    //0.1015
    14727,    //0.1016
    14728,    //0.1017
    14729,    //0.1018
    14730,    //0.1019
    14731,    //0.1020
    14732,    //0.1021
    14733,    //0.1022
    14734,    //0.1023
    14734,    //0.1024
    14735,    //0.1025
    14736,    //0.1026
    14737,    //0.1027
    14738,    //0.1028
    14739,    //0.1029
    14740,    //0.1030
    14741,    //0.1031
    14742,    //0.1032
    14743,    //0.1033
    14744,    //0.1034
    14745,    //0.1035
    14746,    //0.1036
    14747,    //0.1037
    14748,    //0.1038
    14748,    //0.1039
    14749,    //0.1040
    14750,    //0.1041
    14751,    //0.1042
    14752,    //0.1043
    14753,    //0.1044
    14754,    //0.1045
    14755,    //0.1046
    14756,    //0.1047
    14757,    //0.1048
    14758,    //0.1049
    14758,    //0.1050
    14759,    //0.1051
    14760,    //0.1052
    14761,    //0.1053
    14762,    //0.1054
    14763,    //0.1055
    14764,    //0.1056
    14765,    //0.1057
    14766,    //0.1058
    14766,    //0.1059
    14767,    //0.1060
    14768,    //0.1061
    14769,    //0.1062
    14770,    //0.1063
    14771,    //0.1064
    14772,    //0.1065
    14773,    //0.1066
    14773,    //0.1067
    14774,    //0.1068
    14775,    //0.1069
    14776,    //0.1070
    14777,    //0.1071
    14778,    //0.1072
    14779,    //0.1073
    14780,    //0.1074
    14780,    //0.1075
    14781,    //0.1076
    14782,    //0.1077
    14783,    //0.1078
    14784,    //0.1079
    14785,    //0.1080
    14786,    //0.1081
    14786,    //0.1082
    14787,    //0.1083
    14788,    //0.1084
    14789,    //0.1085
    14790,    //0.1086
    14791,    //0.1087
    14791,    //0.1088
    14792,    //0.1089
    14793,    //0.1090
    14794,    //0.1091
    14795,    //0.1092
    14796,    //0.1093
    14796,    //0.1094
    14797,    //0.1095
    14798,    //0.1096
    14799,    //0.1097
    14800,    //0.1098
    14801,    //0.1099
    14801,    //0.1100
    14802,    //0.1101
    14803,    //0.1102
    14804,    //0.1103
    14805,    //0.1104
    14805,    //0.1105
    14806,    //0.1106
    14807,    //0.1107
    14808,    //0.1108
    14809,    //0.1109
    14809,    //0.1110
    14810,    //0.1111
    14811,    //0.1112
    14812,    //0.1113
    14813,    //0.1114
    14813,    //0.1115
    14814,    //0.1116
    14815,    //0.1117
    14816,    //0.1118
    14817,    //0.1119
    14817,    //0.1120
    14818,    //0.1121
    14819,    //0.1122
    14820,    //0.1123
    14821,    //0.1124
    14821,    //0.1125
    14822,    //0.1126
    14823,    //0.1127
    14824,    //0.1128
    14825,    //0.1129
    14825,    //0.1130
    14826,    //0.1131
    14827,    //0.1132
    14828,    //0.1133
    14828,    //0.1134
    14829,    //0.1135
    14830,    //0.1136
    14831,    //0.1137
    14831,    //0.1138
    14832,    //0.1139
    14833,    //0.1140
    14834,    //0.1141
    14835,    //0.1142
    14835,    //0.1143
    14836,    //0.1144
    14837,    //0.1145
    14838,    //0.1146
    14838,    //0.1147
    14839,    //0.1148
    14840,    //0.1149
    14841,    //0.1150
    14841,    //0.1151
    14842,    //0.1152
    14843,    //0.1153
    14844,    //0.1154
    14844,    //0.1155
    14845,    //0.1156
    14846,    //0.1157
    14847,    //0.1158
    14847,    //0.1159
    14848,    //0.1160
    14849,    //0.1161
    14849,    //0.1162
    14850,    //0.1163
    14851,    //0.1164
    14852,    //0.1165
    14852,    //0.1166
    14853,    //0.1167
    14854,    //0.1168
    14855,    //0.1169
    14855,    //0.1170
    14856,    //0.1171
    14857,    //0.1172
    14858,    //0.1173
    14858,    //0.1174
    14859,    //0.1175
    14860,    //0.1176
    14860,    //0.1177
    14861,    //0.1178
    14862,    //0.1179
    14863,    //0.1180
    14863,    //0.1181
    14864,    //0.1182
    14865,    //0.1183
    14865,    //0.1184
    14866,    //0.1185
    14867,    //0.1186
    14867,    //0.1187
    14868,    //0.1188
    14869,    //0.1189
    14870,    //0.1190
    14870,    //0.1191
    14871,    //0.1192
    14872,    //0.1193
    14872,    //0.1194
    14873,    //0.1195
    14874,    //0.1196
    14874,    //0.1197
    14875,    //0.1198
    14876,    //0.1199
    14877,    //0.1200
    14877,    //0.1201
    14878,    //0.1202
    14879,    //0.1203
    14879,    //0.1204
    14880,    //0.1205
    14881,    //0.1206
    14881,    //0.1207
    14882,    //0.1208
    14883,    //0.1209
    14883,    //0.1210
    14884,    //0.1211
    14885,    //0.1212
    14885,    //0.1213
    14886,    //0.1214
    14887,    //0.1215
    14887,    //0.1216
    14888,    //0.1217
    14889,    //0.1218
    14889,    //0.1219
    14890,    //0.1220
    14891,    //0.1221
    14891,    //0.1222
    14892,    //0.1223
    14893,    //0.1224
    14893,    //0.1225
    14894,    //0.1226
    14895,    //0.1227
    14895,    //0.1228
    14896,    //0.1229
    14897,    //0.1230
    14897,    //0.1231
    14898,    //0.1232
    14899,    //0.1233
    14899,    //0.1234
    14900,    //0.1235
    14901,    //0.1236
    14901,    //0.1237
    14902,    //0.1238
    14903,    //0.1239
    14903,    //0.1240
    14904,    //0.1241
    14905,    //0.1242
    14905,    //0.1243
    14906,    //0.1244
    14906,    //0.1245
    14907,    //0.1246
    14908,    //0.1247
    14908,    //0.1248
    14909,    //0.1249
    14910,    //0.1250
    14910,    //0.1251
    14911,    //0.1252
    14912,    //0.1253
    14912,    //0.1254
    14913,    //0.1255
    14913,    //0.1256
    14914,    //0.1257
    14915,    //0.1258
    14915,    //0.1259
    14916,    //0.1260
    14917,    //0.1261
    14917,    //0.1262
    14918,    //0.1263
    14918,    //0.1264
    14919,    //0.1265
    14920,    //0.1266
    14920,    //0.1267
    14921,    //0.1268
    14922,    //0.1269
    14922,    //0.1270
    14923,    //0.1271
    14923,    //0.1272
    14924,    //0.1273
    14925,    //0.1274
    14925,    //0.1275
    14926,    //0.1276
    14926,    //0.1277
    14927,    //0.1278
    14928,    //0.1279
    14928,    //0.1280
    14929,    //0.1281
    14930,    //0.1282
    14930,    //0.1283
    14931,    //0.1284
    14931,    //0.1285
    14932,    //0.1286
    14933,    //0.1287
    14933,    //0.1288
    14934,    //0.1289
    14934,    //0.1290
    14935,    //0.1291
    14936,    //0.1292
    14936,    //0.1293
    14937,    //0.1294
    14937,    //0.1295
    14938,    //0.1296
    14938,    //0.1297
    14939,    //0.1298
    14940,    //0.1299
    14940,    //0.1300
    14941,    //0.1301
    14941,    //0.1302
    14942,    //0.1303
    14943,    //0.1304
    14943,    //0.1305
    14944,    //0.1306
    14944,    //0.1307
    14945,    //0.1308
    14946,    //0.1309
    14946,    //0.1310
    14947,    //0.1311
    14947,    //0.1312
    14948,    //0.1313
    14948,    //0.1314
    14949,    //0.1315
    14950,    //0.1316
    14950,    //0.1317
    14951,    //0.1318
    14951,    //0.1319
    14952,    //0.1320
    14952,    //0.1321
    14953,    //0.1322
    14954,    //0.1323
    14954,    //0.1324
    14955,    //0.1325
    14955,    //0.1326
    14956,    //0.1327
    14956,    //0.1328
    14957,    //0.1329
    14957,    //0.1330
    14958,    //0.1331
    14959,    //0.1332
    14959,    //0.1333
    14960,    //0.1334
    14960,    //0.1335
    14961,    //0.1336
    14961,    //0.1337
    14962,    //0.1338
    14963,    //0.1339
    14963,    //0.1340
    14964,    //0.1341
    14964,    //0.1342
    14965,    //0.1343
    14965,    //0.1344
    14966,    //0.1345
    14966,    //0.1346
    14967,    //0.1347
    14967,    //0.1348
    14968,    //0.1349
    14969,    //0.1350
    14969,    //0.1351
    14970,    //0.1352
    14970,    //0.1353
    14971,    //0.1354
    14971,    //0.1355
    14972,    //0.1356
    14972,    //0.1357
    14973,    //0.1358
    14973,    //0.1359
    14974,    //0.1360
    14975,    //0.1361
    14975,    //0.1362
    14976,    //0.1363
    14976,    //0.1364
    14977,    //0.1365
    14977,    //0.1366
    14978,    //0.1367
    14978,    //0.1368
    14979,    //0.1369
    14979,    //0.1370
    14980,    //0.1371
    14980,    //0.1372
    14981,    //0.1373
    14981,    //0.1374
    14982,    //0.1375
    14982,    //0.1376
    14983,    //0.1377
    14984,    //0.1378
    14984,    //0.1379
    14985,    //0.1380
    14985,    //0.1381
    14986,    //0.1382
    14986,    //0.1383
    14987,    //0.1384
    14987,    //0.1385
    14988,    //0.1386
    14988,    //0.1387
    14989,    //0.1388
    14989,    //0.1389
    14990,    //0.1390
    14990,    //0.1391
    14991,    //0.1392
    14991,    //0.1393
    14992,    //0.1394
    14992,    //0.1395
    14993,    //0.1396
    14993,    //0.1397
    14994,    //0.1398
    14994,    //0.1399
    14995,    //0.1400
    14995,    //0.1401
    14996,    //0.1402
    14996,    //0.1403
    14997,    //0.1404
    14997,    //0.1405
    14998,    //0.1406
    14998,    //0.1407
    14999,    //0.1408
    14999,    //0.1409
    15000,    //0.1410
    15000,    //0.1411
    15001,    //0.1412
    15001,    //0.1413
    15002,    //0.1414
    15002,    //0.1415
    15003,    //0.1416
    15003,    //0.1417
    15004,    //0.1418
    15004,    //0.1419
    15005,    //0.1420
    15005,    //0.1421
    15006,    //0.1422
    15006,    //0.1423
    15007,    //0.1424
    15007,    //0.1425
    15008,    //0.1426
    15008,    //0.1427
    15009,    //0.1428
    15009,    //0.1429
    15010,    //0.1430
    15010,    //0.1431
    15011,    //0.1432
    15011,    //0.1433
    15012,    //0.1434
    15012,    //0.1435
    15013,    //0.1436
    15013,    //0.1437
    15014,    //0.1438
    15014,    //0.1439
    15015,    //0.1440
    15015,    //0.1441
    15016,    //0.1442
    15016,    //0.1443
    15017,    //0.1444
    15017,    //0.1445
    15017,    //0.1446
    15018,    //0.1447
    15018,    //0.1448
    15019,    //0.1449
    15019,    //0.1450
    15020,    //0.1451
    15020,    //0.1452
    15021,    //0.1453
    15021,    //0.1454
    15022,    //0.1455
    15022,    //0.1456
    15023,    //0.1457
    15023,    //0.1458
    15024,    //0.1459
    15024,    //0.1460
    15025,    //0.1461
    15025,    //0.1462
    15025,    //0.1463
    15026,    //0.1464
    15026,    //0.1465
    15027,    //0.1466
    15027,    //0.1467
    15028,    //0.1468
    15028,    //0.1469
    15029,    //0.1470
    15029,    //0.1471
    15030,    //0.1472
    15030,    //0.1473
    15031,    //0.1474
    15031,    //0.1475
    15031,    //0.1476
    15032,    //0.1477
    15032,    //0.1478
    15033,    //0.1479
    15033,    //0.1480
    15034,    //0.1481
    15034,    //0.1482
    15035,    //0.1483
    15035,    //0.1484
    15036,    //0.1485
    15036,    //0.1486
    15036,    //0.1487
    15037,    //0.1488
    15037,    //0.1489
    15038,    //0.1490
    15038,    //0.1491
    15039,    //0.1492
    15039,    //0.1493
    15040,    //0.1494
    15040,    //0.1495
    15041,    //0.1496
    15041,    //0.1497
    15041,    //0.1498
    15042,    //0.1499
    15042	 //0.1500
}; // Table_atan END

static inline float32_t TableSearch_sin(float32_t theta)
{
    while (theta >= MUL_2_PI) theta -= MUL_2_PI;
    while (theta < 0.0f)      theta += MUL_2_PI;

    bool minus_flag = false;
    if (theta > PI) {
        minus_flag = true;
        theta -= PI;
    }

    uint16_t idx = (uint16_t)(theta * 100.0f);
    if (idx >= 316) idx = 315;
    float32_t result = Table_sin[idx];
    return minus_flag ? -result : result;
}

static inline float32_t TableSearch_atan(float32_t theta)
{
    uint16_t idx = (uint16_t)fabsf(theta * 100.0f);
    if (idx > 1500) idx = 1500;
    float32_t output_abs = (float32_t)Table_atan[idx] / 10000.0f;
    return (theta >= 0.0f) ? output_abs : -output_abs;
}

static inline float32_t TableSearch_atan2(float32_t y, float32_t x)
{
    if (x == 0.0f) {
        if      (y > 0.0f) return  DIV_PI_2;
        else if (y < 0.0f) return -DIV_PI_2;
        else               return 0.0f; // (0,0) → 定義為 0
    }

    float32_t base = TableSearch_atan(y / x);
    if (x > 0.0f)
    {
        return base; // Phase 1,4
    }
    else
    {
        return (y >= 0.0f) ? (base + PI) : (base - PI); // Phase 2,3
    }
}

static float wrap_0_2pi(float x)
{
    int32_t n = (int32_t)(x / MUL_2_PI);
    x -= (float)n * MUL_2_PI;
    if (x < 0) x += MUL_2_PI;
    return x;
}

static inline float32_t fast_fabsf(float32_t x) {
    union {
        float32_t f;
        uint32_t u;
    } v = { x };
    v.u &= 0x7FFFFFFF;  // 清除最高位 sign bit
    return v.f;
}

static CORDIC_ConfigTypeDef *cordic_currunt;
static const CORDIC_ConfigTypeDef cordic_cfg_sin_cos = {
    .Function   = CORDIC_FUNCTION_SINE,
    .Precision  = CORDIC_PRECISION_7CYCLES,
    .Scale      = CORDIC_SCALE_0,
    .NbWrite    = CORDIC_NBWRITE_1,
    .NbRead     = CORDIC_NBREAD_2,
    .InSize     = CORDIC_INSIZE_32BITS,
    .OutSize    = CORDIC_OUTSIZE_32BITS,
};
static const CORDIC_ConfigTypeDef cordic_cfg_atan = {
    .Function   = CORDIC_FUNCTION_PHASE,
    .Precision  = CORDIC_PRECISION_7CYCLES,
    .Scale      = CORDIC_SCALE_0,
    .NbWrite    = CORDIC_NBWRITE_2,
    .NbRead     = CORDIC_NBREAD_1,
    .InSize     = CORDIC_INSIZE_32BITS,
    .OutSize    = CORDIC_OUTSIZE_32BITS,
};

Result trigo_sin_cosf(float32_t theta, float32_t *sin, float32_t *cos)
{
    if (cordic_currunt != &cordic_cfg_sin_cos)
    {
        cordic_currunt = &cordic_cfg_sin_cos;
        ERROR_CHECK_HAL_RET_RES(HAL_CORDIC_Configure(&hcordic, cordic_currunt));
    }
    int32_t in = (int32_t)(wrap_0_2pi(theta) * 2147483648.0f);
    int32_t out[2];
    ERROR_CHECK_HAL_RET_RES(HAL_CORDIC_Calculate(&hcordic, &in, out, 1, HAL_MAX_DELAY));
    *sin = (float32_t)out[0] / 2147483648.0f;
    *cos = (float32_t)out[1] / 2147483648.0f;
    return RESULT_OK(NULL);
}

Result trigo_atan(float32_t x, float32_t y, float32_t *theta)
{
    if (cordic_currunt != &cordic_cfg_atan)
    {
        cordic_currunt = &cordic_cfg_atan;
        ERROR_CHECK_HAL_RET_RES(HAL_CORDIC_Configure(&hcordic, cordic_currunt));
    }
    float32_t ax = fast_fabsf(x);
    float32_t ay = fast_fabsf(y);
    float32_t norm = (ax > ay) ? ax : ay;
    if (norm == 0.0f) return RESULT_ERROR(RES_ERR_FAIL);
    x /= norm;
    y /= norm;
    int32_t in[2], out;
    in[0] = (int32_t)(x * 2147483648.0f);  
    in[1] = (int32_t)(y * 2147483648.0f);
    ERROR_CHECK_HAL_RET_RES(HAL_CORDIC_Calculate(&hcordic, in, &out, 1, HAL_MAX_DELAY));
    float32_t angle = (float32_t)out / 2147483648.0f; // [-π, π)
    if (angle < 0) angle += MUL_2_PI;
    *theta = angle;
    return RESULT_OK(NULL);
}
